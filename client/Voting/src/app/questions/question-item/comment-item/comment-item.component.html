<div class="col">
    <div class="d-flex flex-row justify-content-between">
        <div>
            <b>{{comment.userName}}: </b> <span style="color: grey;">{{comment.publishDate | date:'dd.MM.yyyy'}}</span>
        </div>
    </div>
    <div *ngIf="isUpdate" class="">
        <input type="text" class="form-control" [value]="comment.message" #updateInput>
        <div class="btn-toolbar justify-content-end">
            <div class="btn-group mt-2">
                <button type="button" class="btn btn-light" (click)="isUpdate = false">Cancel</button>
                <button type="button" class="btn btn-primary" (click)="updateComment(updateInput.value, comm.id)">Update</button>
            </div>
        </div>
    </div>
    <div class="mb-1" *ngIf="!isUpdate">
        <div class="d-flex flex-row justify-content-between">
            <div class="text-justify pr-4">
                <span>{{comment?.message.length <= 195 ? comment?.message : (readMore ? (comment?.message) : (comment?.message | slice:0:195) + '...')}}</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="dropdown">
                    <svg style="cursor: pointer" width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-three-dots-vertical" fill="currentColor" xmlns="http://www.w3.org/2000/svg" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <path fill-rule="evenodd" d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                    </svg>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                        <div *ngIf="comment.isMine" 
                            class="dropdown-item" 
                            style="cursor: pointer;" 
                            (click)="isUpdate = true">
                            <div class="d-flex flex-row align-items-center">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-pencil-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z"/>
                                </svg>
                                <div class="ml-2">
                                    Update
                                </div>
                            </div>
                        </div>

                        <div *ngIf="comment.isMine" class="dropdown-item" style="cursor: pointer;" (click)="deleteComment(comment.id)">
                            <div class="d-flex flex-row align-items-center">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-trash-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                                </svg>
                                <div class="ml-2">
                                    Delete
                                </div>
                            </div>
                        </div>
                        <div *ngIf="!comment.isMine" class="dropdown-item" style="cursor: pointer;">
                            <div class="d-flex flex-row align-items-center">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-flag-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001"/>
                                </svg>
                                <div class="ml-2">
                                    Report
                                </div>
                            </div>
                        </div>
                        <!-- <div *appUserRole="[ Role.Admin, Role.SuperAdmin]" class="dropdown-item" style="cursor: pointer;">
                            <div class="d-flex flex-row align-items-center">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-flag-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001"/>
                                </svg>
                                <div class="ml-2">
                                    Block
                                </div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-column">
            <div class="text-secondary" style="cursor: pointer;" *ngIf="comment.message.length > 195" (click)="readMore = !readMore">Read {{readMore ? 'less': 'more'}}</div>
            <div class="text-muted" *ngIf="parentId === undefined">
                <span style="cursor: pointer;" (click)="showCommentForm = !showCommentForm">REPLY</span>
            </div>
        </div>
        <div *ngIf="showCommentForm" class="mt-1 mb-1">
            <form (submit)="sendComment()">
                <input type="text" class="form-control" placeholder="Leave a comment" [(ngModel)]="replyComment" name="replyComment">
                <div class="btn-toolbar justify-content-end">
                    <div class="btn-group mt-2">
                        <button type="button" class="btn btn-light" (click)="showCommentForm = false">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div>
        <span *ngIf="comment.answersCount !== 0" 
            class="mt-1 text-primary" 
            style="cursor: pointer;" 
            (click)="comment.comments?.length > 0 ? (showChildComments = !showChildComments  ): loadAnswers(comment.id)">
            {{comment.answersCount}} answers
        </span>
    </div>
    
    <div *ngIf="showChildComments" class="mt-2">
        <div *ngFor="let childComment of comment.comments" class="pl-3">
            <app-comment-item
                class="row"
                (delete)="deleteComment($event)"
                (update)="updateChildComment($event)"
                [comment]="childComment"
                [parentId]="comment.id">
            </app-comment-item>
        </div>
    </div>
</div>